<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>TverskyLoss - U-Net & AttentionUNet -  Brain Tumor segmentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "TverskyLoss";
        var mkdocs_page_input_path = "TverskyLoss.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> U-Net & AttentionUNet -  Brain Tumor segmentation
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../dataloader/">DataLoader</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../encoder/">Encoder</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../decoder/">Decoder</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../attention_block/">Attention-Block</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../UNet/">U-Net</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../AttentionUNet/">AttentionUNet</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../DiceLoss/">DiceLoss</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../DiceBCELoss/">DiceBCELoss</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../FocalLoss/">FocalLoss</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../JaccardLoss/">JaccardLoss</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">TverskyLoss</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#instantiating-tversky-loss">Instantiating Tversky Loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#applying-tversky-loss">Applying Tversky Loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#command-line-interface">Command Line Interface</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#parameters-and-arguments">Parameters and Arguments</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#class-parameters">Class Parameters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cli-arguments">CLI Arguments</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../DiceBCELoss/">DiceBCELoss</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ComboLoss/">ComboLoss</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../trainer/">Trainer</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../charts/">Charts</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cli/">CLI</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CustomModuls/">Custom Modules</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">U-Net & AttentionUNet -  Brain Tumor segmentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">TverskyLoss</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="tversky-loss-for-image-segmentation">Tversky Loss for Image Segmentation</h1>
<h2 id="overview">Overview</h2>
<p>The <code>TverskyLoss</code> class implements the Tversky Loss function, a flexible and generalization of the Dice Loss that allows for the adjustment of the importance between false positives and false negatives. This adjustment capability makes it particularly useful for segmentation tasks with imbalanced datasets.</p>
<h2 id="installation">Installation</h2>
<p>This implementation requires Python and PyTorch. If you haven't already, install Python on your system and follow the <a href="https://pytorch.org/get-started/locally/">PyTorch official installation guide</a> to set up PyTorch.</p>
<h2 id="dependencies">Dependencies</h2>
<ul>
<li>Python 3.x</li>
<li>PyTorch</li>
</ul>
<p>To install PyTorch via pip, run:</p>
<pre><code class="language-sh">pip install torch torchvision
</code></pre>
<h2 id="usage">Usage</h2>
<h3 id="instantiating-tversky-loss">Instantiating Tversky Loss</h3>
<p>Create an instance of <code>TverskyLoss</code> with an optional smoothing factor to prevent division by zero in the loss calculation:</p>
<pre><code class="language-python">from tversky_loss import TverskyLoss  # Assuming the class is saved in tversky_loss.py

tversky_loss = TverskyLoss(smooth=1e-6)
</code></pre>
<h3 id="applying-tversky-loss">Applying Tversky Loss</h3>
<p>Incorporate <code>TverskyLoss</code> in your training loop to handle imbalanced segmentation data:</p>
<pre><code class="language-python">model = UNet()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

predicted = model(input_data)  # input_data is your batch of input images
actual = target_data  # target_data is your batch of target segmentation masks

loss = tversky_loss(predicted, actual)
loss.backward()
optimizer.step()
</code></pre>
<h3 id="command-line-interface">Command Line Interface</h3>
<p>A simple CLI is included for testing the Tversky Loss function directly:</p>
<pre><code class="language-sh">python tversky_loss.py --smooth 1e-6
</code></pre>
<h2 id="parameters-and-arguments">Parameters and Arguments</h2>
<h3 id="class-parameters">Class Parameters</h3>
<p><code>TverskyLoss</code> initialization parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>smooth</td>
<td>float</td>
<td>1e-6</td>
<td>Smoothing factor to prevent division by zero.</td>
</tr>
</tbody>
</table>
<h3 id="cli-arguments">CLI Arguments</h3>
<p>Arguments for testing <code>TverskyLoss</code> via the command line:</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--smooth</code></td>
<td>float</td>
<td>1e-6</td>
<td>Smoothing factor for Tversky Loss calculation.</td>
</tr>
</tbody>
</table>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../JaccardLoss/" class="btn btn-neutral float-left" title="JaccardLoss"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../DiceBCELoss/" class="btn btn-neutral float-right" title="DiceBCELoss">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../JaccardLoss/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../DiceBCELoss/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
